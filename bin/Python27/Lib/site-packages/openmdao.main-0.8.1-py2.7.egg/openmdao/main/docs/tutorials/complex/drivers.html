
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Drivers for Simulation &mdash; OpenMDAO Documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.8.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="OpenMDAO Documentation" href="../../index.html" />
    <link rel="up" title="A More Complex Tutorial Problem" href="index.html" />
    <link rel="next" title="Setting up an Optimization Problem" href="setting_up_opt.html" />
    <link rel="prev" title="Assemblies" href="assemblies.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="setting_up_opt.html" title="Setting up an Optimization Problem"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="assemblies.html" title="Assemblies"
             accesskey="P">previous</a> |</li>
  <li><a href="http://openmdao.org">OpenMDAO Home</a> &raquo;</li>
  
        <li><a href="../../index.html">OpenMDAO Documentation v0.8.1</a> &raquo;</li>

          <li><a href="../index.html" >OpenMDAO Tutorials</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">A More Complex Tutorial Problem</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="drivers-for-simulation">
<span id="index-0"></span><h1>Drivers for Simulation<a class="headerlink" href="#drivers-for-simulation" title="Permalink to this headline">Â¶</a></h1>
<p>Now that we have a functional and quick Vehicle assembly, we need to complete
the problem by providing a way to simulate the acceleration and the EPA fuel
economy estimates. The acceleration test requires an integration in time to
match a specified velocity profile. In other words, the vehicle assembly needs
to be executed at each time step to produce the instantaneous acceleration.
The EPA fuel economy tests are a bit more tricky, though they also require an integration in
time. For these tests, the vehicle assembly must be executed while varying the throttle and
gear position inputs to match a desired acceleration for the integration
segment. Both of these solution procedures were implemented in Python as <em>drivers.</em> The
SimAcceleration driver simulates the acceleration test, and the SimEconomy driver
simulates the EPA fuel economy test.</p>
<p>Recall that in the <a class="reference internal" href="../optimization/index.html#optimization-tutorial"><em>Optimization Tutorial</em></a>, a
Driver called <cite>CONMINdriver</cite> was used to optimize the Paraboloid problem.
Similarly, the algorithms that perform these tests have been implemented as
OpenMDAO drivers that can be found in <tt class="docutils literal"><span class="pre">driving_sim.py</span></tt>. These drivers use
the parameter interface to specify the variables that will be driven by the
simulation drivers. Specifically, to drive the Vehicle assembly, the
simulation driver needs to be able to set the velocity, throttle, and gear
positions. Likewise, it also needs to be able to read variables from the
vehicle component and does so with the objectives interface. For the
acceleration test, the vehicle&#8217;s instantaneous acceleration is needed, and
for the economy test, both the acceleration and fuel burn are needed.</p>
<p>You may want to examine the SimAcceleration and the SimEconomy drivers that are
found in <tt class="docutils literal"><span class="pre">driving_sim.py</span></tt>. This tutorial does not cover how to create an OpenMDAO
Driver, but a future tutorial will teach this. Until then, you can gain some understanding
by studying these drivers, as well as the ones included in the standard library.</p>
<p>The simulation drivers have a variable that stores the result of the simulation:</p>
<p><strong>SimAcceleration - Output:</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="63%" />
<col width="12%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Variable</th>
<th class="head">Description</th>
<th class="head">Units</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">accel_time</span></tt></td>
<td>Time for vehicle to accelerate to 60 mph
from a stop.</td>
<td>s</td>
</tr>
</tbody>
</table>
<p><strong>SimEconomy - Output:</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="63%" />
<col width="12%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Variable</th>
<th class="head">Description</th>
<th class="head">Units</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">fuel_economy</span></tt></td>
<td>Fuel economy estimate based on EPA
driving profile</td>
<td>mi/galUS</td>
</tr>
</tbody>
</table>
<p>These variables can be accessed like any other component output and can be connected to the
input of another OpenMDAO component if needed.</p>
<p>Let&#8217;s set up a model that runs all three of these simulations to calculate
these results: 0-60 acceleration time, EPA city mpg, and EPA highway mpg. To build this model, we need to learn a little more about the <a class="reference internal" href="../../glossary.html#term-iteration-hierarchy"><em class="xref std std-term">iteration hierarchy</em></a>. In
the simple example, we used the iteration hierarchy to define a problem which contained
an optimizer and a simple Python component. The iteration hierarchy was defined by adding
the component to the driver&#8217;s workflow with the <tt class="docutils literal"><span class="pre">add</span></tt> method. If we want to run the
SimAcceleration driver on the  Vehicle  component, we can set up a similar iteration
hierarchy where we add the Vehicle component to the SimAcceleration driver&#8217;s workflow. The
top level assembly would look like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">openmdao.main.api</span> <span class="kn">import</span> <span class="n">Assembly</span>
<span class="kn">from</span> <span class="nn">openmdao.examples.enginedesign.driving_sim</span> <span class="kn">import</span> <span class="n">SimAcceleration</span>
<span class="kn">from</span> <span class="nn">openmdao.examples.enginedesign.vehicle</span> <span class="kn">import</span> <span class="n">Vehicle</span>

<span class="k">class</span> <span class="nc">VehicleSim</span><span class="p">(</span><span class="n">Assembly</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Optimization of a Vehicle.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c"># Create Vehicle instance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;vehicle&#39;</span><span class="p">,</span> <span class="n">Vehicle</span><span class="p">())</span>

        <span class="c"># Create 0-60 Acceleration Simulation instance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;driver&#39;</span><span class="p">,</span> <span class="n">SimAcceleration</span><span class="p">())</span>

        <span class="c"># Add vehicle to sim workflows.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">workflow</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;vehicle&#39;</span><span class="p">)</span>

        <span class="c"># Acceleration Sim setup</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_acc</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;vehicle.velocity&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;velocity&#39;</span><span class="p">,</span>
                                   <span class="n">low</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">150.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_acc</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;vehicle.throttle&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;throttle&#39;</span><span class="p">,</span>
                                   <span class="n">low</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_acc</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;vehicle.current_gear&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;gear&#39;</span><span class="p">,</span>
                                   <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sim_acc</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s">&#39;vehicle.acceleration&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;acceleration&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_acc</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s">&#39;vehicle.overspeed&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;overspeed&#39;</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="n">my_sim</span> <span class="o">=</span> <span class="n">VehicleSim</span><span class="p">()</span>
    <span class="n">my_sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

    <span class="k">print</span> <span class="s">&quot;Time (0-60): &quot;</span><span class="p">,</span> <span class="n">my_sim</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">accel_time</span>
</pre></div>
</div>
<p>Here, we add a SimAcceleration instance as our top level driver, and then we add our Vehicle
instance to the driver&#8217;s workflow. We also specify the locations of the vehicle variables we need
to manipulate and read using the <tt class="docutils literal"><span class="pre">add_parameter</span></tt> and <tt class="docutils literal"><span class="pre">add_objective</span></tt> methods. Here, we
introduce the optional argument <cite>name</cite>, which allows you to specify a unique name for the
parameter. The SimAcceleration driver looks for a parameter with the name <em>gear</em> whenever it
needs to set the gear. This is required so that the driver knows which of the parameters is
the gear position. The objectives are also given a name so that SimAcceleration knows which
variable is the acceleration and which is the overspeed indicator. This driver supports
multiple objectives, so we add them sequentially using <tt class="docutils literal"><span class="pre">add_objective</span></tt>.</p>
<p>This is a very simple problem, and hence the workflows and iteration hierarchy are also very
simple. In OpenMDAO, you can build models with arbitrary levels of complexity. To
understand how this works, it is beneficial to use a diagram like this:</p>
<div class="figure align-center">
<img alt="Diagram of process model showing the vehicle assembly, some simulation drivers, and the optimizer" src="../../_images/Driver_Process_Definition3.png" />
<p class="caption">Iteration Hierarchy for One Vehicle Simulation</p>
</div>
<p>This is the iteration hierarchy for the model we just built. The gray rounded-rectangles represent
drivers, the white rounded-rectangles represent components, and the yellow rectangles represent
workflows. The gray rounded-rectangle in the upper left-hand corner of a yellow rectangle is the driver that
owns that workflow. The remaining items in that rectangle are the components that are contained
within that workflow. Note that a workflow can also contain assemblies and drivers, though in this
case it just contains a component.</p>
<p>The top level driver in an assembly is always called <em>driver.</em> If no specific
driver instance (e.g., SimAcceleration in our example) is declared with the
name <cite>driver</cite>, then the assembly&#8217;s default driver is used. The behavior for
this default driver is to execute the components in its workflow sequentially,
inferring the execution order from the data connections. If there are no data
connections, then the components are executed in the order they were added to
the workflow.</p>
<p>When we created the Vehicle component above, we used this default driver to
create a sequential execution of the Transmission, Engine, and Chassis components
in the order that the data connections required. The iteration hierarchy is
shown in this diagram:</p>
<div class="figure align-center">
<img alt="Diagram of process model showing the vehicle assembly, some simulation drivers, and the optimizer" src="../../_images/Driver_Process_Definition4.png" />
<p class="caption">Iteration Hierarchy for Vehicle Component</p>
</div>
<p>Notice that the workflow contains the three components that we used to build the vehicle
assembly. The top level driver of the assembly is just called <cite>driver.</cite></p>
<p>Now, let&#8217;s see how we can make a new assembly that performs all three simulations. Just
as we did with the Vehicle assembly, we want to run these three simulations
sequentially. In this case, they are drivers, but the mechanics of adding a driver
to another driver&#8217;s workflow is the same as with a component. An additional <cite>level</cite>
is introduced to this iteration hierarchy because each of the simulation drivers
also has its own workflow. Each of these workflows contains the Vehicle instance. The
iteration hierarchy for a model that performs the 0-60 accelerations test, the EPA
city estimated fuel economy test, and the EPA highway estimated fuel economy test
is shown in this diagram:</p>
<div class="figure align-center">
<img alt="Diagram of process model showing the vehicle assembly, some simulation drivers, and the optimizer" src="../../_images/Driver_Process_Definition2.png" />
<p class="caption">Iteration Hierarchy for All Vehicle Simulations</p>
</div>
<p>Again, the top level driver commands a sequential execution of the SimAcceleration instance and
the two SimEconomy instances. The three simulation drivers contain the same Vehicle instance in
each of their workflows. That means, that when one driver finished with its simulation, the inputs
and outputs of the vehicle component remain set to whatever the last values from that simulation
were. The next driver then resets the velocity to <cite>0</cite>, the throttle to <cite>idle,</cite> and the gear to <cite>first</cite>
before starting its own simulation.</p>
<p>Now, let&#8217;s build a new assembly that includes all three simulations run sequentially.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">openmdao.main.api</span> <span class="kn">import</span> <span class="n">Assembly</span>
<span class="kn">from</span> <span class="nn">openmdao.examples.enginedesign.driving_sim</span> <span class="kn">import</span> <span class="n">SimAcceleration</span><span class="p">,</span> \
                                                       <span class="n">SimEconomy</span>
<span class="kn">from</span> <span class="nn">openmdao.examples.enginedesign.vehicle</span> <span class="kn">import</span> <span class="n">Vehicle</span>

<span class="k">class</span> <span class="nc">VehicleSim2</span><span class="p">(</span><span class="n">Assembly</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Optimization of a Vehicle.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c"># Create Vehicle instance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;vehicle&#39;</span><span class="p">,</span> <span class="n">Vehicle</span><span class="p">())</span>

        <span class="c"># Create Driving Simulation instances</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;sim_acc&#39;</span><span class="p">,</span> <span class="n">SimAcceleration</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;sim_EPA_city&#39;</span><span class="p">,</span> <span class="n">SimEconomy</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;sim_EPA_highway&#39;</span><span class="p">,</span> <span class="n">SimEconomy</span><span class="p">())</span>

        <span class="c"># add Sims to default workflow</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">workflow</span><span class="o">.</span><span class="n">add</span><span class="p">([</span><span class="s">&#39;sim_acc&#39;</span><span class="p">,</span> <span class="s">&#39;sim_EPA_city&#39;</span><span class="p">,</span> <span class="s">&#39;sim_EPA_highway&#39;</span><span class="p">])</span>

        <span class="c"># Add vehicle to sim workflows.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_acc</span><span class="o">.</span><span class="n">workflow</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;vehicle&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_EPA_city</span><span class="o">.</span><span class="n">workflow</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;vehicle&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_EPA_highway</span><span class="o">.</span><span class="n">workflow</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&#39;vehicle&#39;</span><span class="p">)</span>

        <span class="c"># Acceleration Sim setup</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_acc</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;vehicle.velocity&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;velocity&#39;</span><span class="p">,</span>
                                   <span class="n">low</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">150.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_acc</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;vehicle.throttle&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;throttle&#39;</span><span class="p">,</span>
                                   <span class="n">low</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_acc</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;vehicle.current_gear&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;gear&#39;</span><span class="p">,</span>
                                   <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_acc</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s">&#39;vehicle.acceleration&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;acceleration&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_acc</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s">&#39;vehicle.overspeed&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;overspeed&#39;</span><span class="p">)</span>

        <span class="c"># EPA City MPG Sim Setup</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_EPA_city</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;vehicle.velocity&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;velocity&#39;</span><span class="p">,</span>
                                        <span class="n">low</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">150.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_EPA_city</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;vehicle.throttle&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;throttle&#39;</span><span class="p">,</span>
                                        <span class="n">low</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_EPA_city</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;vehicle.current_gear&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;gear&#39;</span><span class="p">,</span>
                                        <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_EPA_city</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s">&#39;vehicle.acceleration&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;acceleration&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_EPA_city</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s">&#39;vehicle.fuel_burn&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;fuel_burn&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_EPA_city</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s">&#39;vehicle.overspeed&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;overspeed&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_EPA_city</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s">&#39;vehicle.underspeed&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;underspeed&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_EPA_city</span><span class="o">.</span><span class="n">profilename</span> <span class="o">=</span> <span class="s">&#39;EPA-city.csv&#39;</span>

        <span class="c"># EPA Highway MPG Sim Setup</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_EPA_highway</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;vehicle.velocity&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;velocity&#39;</span><span class="p">,</span>
                                           <span class="n">low</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_EPA_highway</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;vehicle.throttle&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;throttle&#39;</span><span class="p">,</span>
                                           <span class="n">low</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_EPA_highway</span><span class="o">.</span><span class="n">add_parameter</span><span class="p">(</span><span class="s">&#39;vehicle.current_gear&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;gear&#39;</span><span class="p">,</span>
                                           <span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_EPA_highway</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s">&#39;vehicle.acceleration&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;acceleration&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_EPA_highway</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s">&#39;vehicle.fuel_burn&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;fuel_burn&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_EPA_highway</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s">&#39;vehicle.overspeed&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;overspeed&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_EPA_highway</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s">&#39;vehicle.underspeed&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;underspeed&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim_EPA_highway</span><span class="o">.</span><span class="n">profilename</span> <span class="o">=</span> <span class="s">&#39;EPA-highway.csv&#39;</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="n">my_sim</span> <span class="o">=</span> <span class="n">VehicleSim2</span><span class="p">()</span>
    <span class="n">my_sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

    <span class="k">print</span> <span class="s">&quot;Time (0-60): &quot;</span><span class="p">,</span> <span class="n">my_sim</span><span class="o">.</span><span class="n">sim_acc</span><span class="o">.</span><span class="n">accel_time</span>
    <span class="k">print</span> <span class="s">&quot;City MPG: &quot;</span><span class="p">,</span> <span class="n">my_sim</span><span class="o">.</span><span class="n">sim_EPA_city</span><span class="o">.</span><span class="n">fuel_economy</span>
    <span class="k">print</span> <span class="s">&quot;Highway MPG: &quot;</span><span class="p">,</span> <span class="n">my_sim</span><span class="o">.</span><span class="n">sim_EPA_highway</span><span class="o">.</span><span class="n">fuel_economy</span>
</pre></div>
</div>
<p>First, all of the components are instantiated in the assembly, including the Vehicle
instance, the SimAcceleration instance, and the two SimEconomy instances, which are named
<tt class="docutils literal"><span class="pre">sim_EPA_city</span></tt> and <tt class="docutils literal"><span class="pre">sim_EPA_highway</span></tt>. Next, the three simulation component instances
are added to the driver&#8217;s workflow. Multiple components can be added to a workflow
with a single call to <tt class="docutils literal"><span class="pre">add</span></tt> by passing a list of the name strings. Since there are no
data connections between them, they will be executed in the order they appear in
this list.</p>
<p>Each simulation driver has a workflow, so the <cite>vehicle</cite> instance is added to each
of their workflows. After that, the simulation connections are specified. The variable
<cite>profilename</cite> is the name of the file that contains the EPA driving profile, which
is essentially velocity as a function of time.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<a href="http://openmdao.org">
 <img src="../../_static/OpenMDAO_Logo_200w_padded.png"
border="0" alt="OpenMDAO Home"/>
</a>

  <h4>Previous topic</h4>
  <p class="topless"><a href="assemblies.html"
                        title="previous chapter">Assemblies</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="setting_up_opt.html"
                        title="next chapter">Setting up an Optimization Problem</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/tutorials/complex/drivers.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="setting_up_opt.html" title="Setting up an Optimization Problem"
             >next</a> |</li>
        <li class="right" >
          <a href="assemblies.html" title="Assemblies"
             >previous</a> |</li>
  <li><a href="http://openmdao.org">OpenMDAO Home</a> &raquo;</li>
  
        <li><a href="../../index.html">OpenMDAO Documentation v0.8.1</a> &raquo;</li>

          <li><a href="../index.html" >OpenMDAO Tutorials</a> &raquo;</li>
          <li><a href="index.html" >A More Complex Tutorial Problem</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright none.
      Last updated on Aug 26, 2013.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>